---
title: "Test Rmd File"
author: "Daniel Allington"
date: "2026-02-10"
output: html_document
---

In this Rmd file, we develop and test basic bits of code.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(dplyr)
library(purrr)
```

```{r}
population.p <- .5
population.N <- 10000

population <- c(rep(1, population.N * population.p), rep(0, population.N * (1 - population.p)))
```

```{r}
take.sample <- function(x, n) {
  proportion.to.sample <- n / length(x)
  y <- rnorm(n = n)
  sampling.p <- ecdf(y)(y) * proportion.to.sample * 2
  x[runif(n = length(x)) < sampling.p]
}

(1:1000) %>%
  map(
    function(x) {
      x <- take.sample(population, 1000)
      tibble(n = length(x), p = mean(x))
    }
  ) %>%
  reduce(rbind) %>%
  summarise(
    n = mean(n),
    Low = quantile(p, .025),
    Est. = mean(p),
    High = quantile(p, .975)
  )
```
